# 手動テスト手順書

## 概要

FFmpeg Command Generator の手動テスト手順書。
デプロイ前・リリース前に実施する。

---

## 0. テスト環境セットアップ

```bash
npm install
npm run dev
# → http://localhost:5173 を開く
```

**テスト対象ブラウザ**: Chrome (最新), Firefox (最新), Safari (最新)

---

## 1. 基本動作テスト

### 1.1 ページ表示

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 1-1 | http://localhost:5173 を開く | ページが表示される。コンソールにエラーなし | |
| 1-2 | ヘッダーを確認 | 「FFmpeg コマンドジェネレーター」タイトル、EN切替ボタン、テーマ切替ボタンが表示 | |
| 1-3 | プリセットグリッドを確認 | 8枚のプリセットカードがグリッド表示（AVIF, WebP, AV1, 動画変換, 音声抽出, 音声変換, トリム, GIF） | |
| 1-4 | コマンド出力エリアを確認 | 「生成されたコマンド」ヘッダー、「FFmpegの導入」「実行方法」「コピー」の3ボタンが表示 | |
| 1-5 | フッターを確認 | 説明文が表示 | |

### 1.2 プリセットアイコン

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 1-6 | プリセットカードのアイコンを確認 | 各カードにLucide SVGアイコンが表示（絵文字ではない） | |
| 1-7 | アイコンの色を確認 | 各アイコンにカラフルな背景色+前景色が付いている | |
| 1-8 | DropZoneのフォルダアイコンを確認 | Lucide FolderIcon（SVG）が表示されている | |

---

## 2. テーマ切替テスト

### 2.1 ライトテーマ（ペールトーン）

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 2-1 | ライトモードで表示 | 背景が薄いラベンダー白、テキストが濃色、カードに薄い影 | |
| 2-2 | プリセットカードのアイコン色を確認 | パステル調の背景色（淡い緑、淡い紫など） | |

### 2.2 ダークテーマ（サイバーパンク）

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 2-3 | テーマ切替ボタン（月アイコン）をクリック | ダークモードに切り替わる。ボタンが太陽アイコンに変わる | |
| 2-4 | 背景色を確認 | 深い青黒（サイバーパンク風） | |
| 2-5 | アクセント色を確認 | ネオンマゼンタ/シアンのアクセントカラーが適用されている | |
| 2-6 | アイコン色を確認 | ネオン調の鮮やかな色に変わっている | |
| 2-7 | ページをリロード | ダークモードが維持される（FOUC なし、一瞬ライトが見えない） | |

### 2.3 テーマ永続化

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 2-8 | ライトに戻してリロード | ライトモードが維持される | |
| 2-9 | localStorage を削除してリロード | OS設定に従ったテーマが適用される | |

---

## 3. プリセット選択テスト

### 3.1 各プリセットの動作

| # | プリセット | 期待コマンド（概要） | OK/NG |
|---|-----------|---------------------|-------|
| 3-1 | 画像圧縮（AVIF） | `ffmpeg -y -i input.png -c:v libaom-av1 -crf 30 -b:v 0 -pix_fmt yuv420p10le -aom-params tune=iq -an output.avif` | |
| 3-2 | 画像圧縮（WebP） | `ffmpeg -y -i input.png -c:v libwebp -quality 75 -an output.webp` | |
| 3-3 | 動画圧縮（AV1） | `ffmpeg -y -i input.mp4 -c:v libsvtav1 -crf 30 -pix_fmt yuv420p10le -preset 6 -svtav1-params tune=0:enable-overlays=1:scd=1 -c:a libopus -b:a 128k output.mp4` | |
| 3-4 | 動画フォーマット変換 | `ffmpeg -y -i input.mp4 -c:v libvpx-vp9 -crf 30 -c:a libopus -b:a 128k output.webm` | |
| 3-5 | 音声抽出 | `ffmpeg -y -i input.mp4 -vn -c:a libmp3lame -b:a 192k output.mp3` | |
| 3-6 | 音声変換 | `ffmpeg -y -i input.wav -vn -c:a libmp3lame -b:a 192k output.mp3` | |
| 3-7 | 動画トリム | `ffmpeg -y -ss 00:00:00 -i input.mp4 -c copy -to 00:00:30 output.mp4` | |
| 3-8 | GIF生成 | パレット生成 + GIF生成の2コマンド（`palettegen` + `paletteuse`） | |

### 3.2 カスタマイズ — 基本入力

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 3-9 | プリセット選択後、カスタマイザーが表示される | 編集可能フィールドがフォームで表示 | |
| 3-10 | 入力ファイル名を変更 | コマンドの入力ファイル名が即座に反映 | |
| 3-11 | 出力ファイル名を変更 | コマンドの出力ファイル名が即座に反映 | |

### 3.3 カスタマイズ — スライダー操作

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 3-12 | AVIF: CRFスライダーを30→20に変更 | ラベルが「CRF（品質）: 20」に変わり、コマンドの `-crf 20` に反映 | |
| 3-13 | WebP: 品質スライダーを75→90に変更 | ラベルが「品質: 90」に変わり、コマンドの `-quality 90` に反映 | |
| 3-14 | AV1動画: エンコード速度を6→10に変更 | ラベルが「エンコード速度: 10」に変わり、コマンドの `-preset 10` に反映 | |
| 3-15 | AV1動画: CRFスライダーを30→25に変更 | ラベルが「CRF（品質）: 25」に変わり、コマンドの `-crf 25` に反映 | |

### 3.4 カスタマイズ — コーデック/フォーマット切替

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 3-16 | 動画圧縮: コーデックを「AV1 (SVT-AV1 — 高速)」→「H.264 (libx264)」に変更 | コマンドが `-c:v libx264` に切替わる。フォーマットが互換形式に自動調整 | |
| 3-17 | 動画圧縮: フォーマットを「mp4」→「mkv」に変更 | 出力ファイル名の拡張子が `.mkv` に変わる | |
| 3-18 | 動画圧縮: 音声コーデックを「Opus」→「AAC」に変更 | コマンドの `-c:a` が `aac` に反映 | |
| 3-19 | 動画圧縮: 音声ビットレートを「128k」→「256k」に変更 | コマンドの `-b:a 256k` に反映 | |
| 3-20 | 動画圧縮(AV1)のデフォルト出力が `.mp4` であること | 初期選択時に `output.mp4` と表示 | |

### 3.5 カスタマイズ — アスペクト比ロック

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 3-21 | 画像をD&D → 幅フィールドを変更 | 高さが自動計算されアスペクト比が維持される | |
| 3-22 | ロックアイコンをクリックして解除 | アイコンが UnlockIcon に変わり、幅変更時に高さが連動しなくなる | |
| 3-23 | 再度ロックアイコンをクリック | アイコンが LockIcon に戻り、連動が復活 | |

---

## 4. ドラッグ＆ドロップテスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 4-1 | ファイルをD&Dエリアにドラッグ | ドロップゾーンがハイライト表示。Lucide FolderIcon が表示されている | |
| 4-2 | 単一画像ファイルをドロップ | ファイル名が検出され、コマンドの入力ファイル名に反映。幅/高さが自動取得 | |
| 4-3 | 単一動画ファイルをドロップ | ファイル名が検出され、幅/高さが自動取得 | |
| 4-4 | 複数ファイルをドロップ | バッチモードに切り替わり、ファイル一覧が表示 | |
| 4-5 | バッチモード時のタブ切替 | Bash / PowerShell / cmd タブが切替可能 | |
| 4-6 | クリアボタン | ファイルがクリアされ、通常モードに戻る | |

---

## 5. コマンド出力テスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 5-1 | コマンドが表示されている状態でコピーボタンをクリック | 「コピーしました」に変わり、クリップボードにコマンドがコピーされる | |
| 5-2 | コピー後2秒待つ | ボタンが「コピー」に戻る | |
| 5-3 | コマンド未生成状態 | コピーボタンが無効化（disabled） | |

---

## 6. FFmpegインストールガイドテスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 6-1 | 「FFmpegの導入」ボタンをクリック | インストールガイドモーダルが開く | |
| 6-2 | macOSタブを確認 | Homebrew導入コマンドと `brew install ffmpeg` が表示 | |
| 6-3 | Windowsタブをクリック | winget / Chocolatey / 手動ダウンロードの3方法が表示 | |
| 6-4 | Windows: AV1/AVIF拡張機能セクション | 「AV1/AVIF ファイルの表示」セクションが表示。MonitorIcon + 説明文 + Microsoft Storeリンク | |
| 6-5 | Windows: AV1拡張機能リンク | 「AV1 Video Extensions を入手」リンクが `https://apps.microsoft.com/detail/9p13g73d7rmz` を指していること | |
| 6-6 | Linuxタブをクリック | Ubuntu/Debian, Fedora, Arch Linux の3ディストリビューションが表示 | |
| 6-7 | インストール確認セクション | `ffmpeg -version` コマンドが表示 | |
| 6-8 | 公式サイトリンク | ffmpeg.org へのリンクが表示され、クリックで別タブで開く | |
| 6-9 | Windowsの gyan.dev リンク | 別タブで開く | |
| 6-10 | モーダルスクロール | 内容が多くてもモーダル内でスクロール可能（`max-h-[70vh] overflow-y-auto`） | |
| 6-11 | ×ボタンでモーダルを閉じる | モーダルが閉じる | |

---

## 7. 実行方法ガイドテスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 7-1 | 「実行方法」ボタンをクリック | 実行方法モーダルが開く。Lucide InfoIcon が表示 | |
| 7-2 | 4ステップの手順を確認 | コピー → ターミナルを開く → cd → 貼り付けて実行 | |
| 7-3 | ヒントセクション | macOS / Windows / Linux のターミナルの開き方が表示 | |
| 7-4 | インストールガイドリンク | 「FFmpegがまだインストールされていない場合は **インストールガイド**」が表示 | |
| 7-5 | インストールガイドリンクをクリック | 実行方法モーダルが閉じ、インストールガイドモーダルが開く | |
| 7-6 | 注意書き | ブラウザのセキュリティ制限に関する説明が表示 | |
| 7-7 | モーダルスクロール | 内容が多くてもモーダル内でスクロール可能 | |

---

## 8. 言語切替テスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 8-1 | 「EN」ボタンをクリック | UI全体が英語に切り替わる | |
| 8-2 | ヘッダータイトルを確認 | "FFmpeg Command Generator" と表示 | |
| 8-3 | プリセット名を確認 | 英語のプリセット名（"Video Format Conversion" 等） | |
| 8-4 | ガイドボタンを確認 | "Install FFmpeg" / "How to Run" に切り替わっている | |
| 8-5 | インストールガイドモーダル（英語） | 英語で表示。Windows AV1拡張セクションは "Viewing AV1/AVIF Files" | |
| 8-6 | 実行方法モーダル（英語） | 英語で表示される | |
| 8-7 | 日本語に戻す | UI全体が日本語に戻る | |
| 8-8 | インストールガイドモーダル（日本語） | 日本語で表示。Windows AV1拡張セクションは「AV1/AVIF ファイルの表示」 | |
| 8-9 | HTML lang属性を確認 | 日本語時: `<html lang="ja">`、英語時: `<html lang="en">` | |
| 8-10 | リロード | 選択した言語が維持される | |

---

## 9. レスポンシブテスト

| # | 画面幅 | 確認項目 | OK/NG |
|---|--------|---------|-------|
| 9-1 | デスクトップ (1280px+) | プリセットが4列グリッド | |
| 9-2 | タブレット (768px) | プリセットが2列グリッド | |
| 9-3 | モバイル (375px) | プリセットが1列、ボタンが収まる | |
| 9-4 | モバイルでモーダル | モーダルが画面内に収まり、スクロール可能 | |

---

## 10. CI/CD チェック

```bash
# ローカルで全チェック実行
npm run check          # 型チェック — 0エラー
npm run build          # プロダクションビルド — 0エラー
bash scripts/lint-css.sh  # CSSリント — PASSED

# 以下がすべてPASSED であること
```

| # | チェック項目 | コマンド | 期待結果 | OK/NG |
|---|-------------|---------|---------|-------|
| 10-1 | 型チェック | `npm run check` | 0 errors | |
| 10-2 | ビルド | `npm run build` | 0 errors, `✔ done` | |
| 10-3 | CSSリント | `bash scripts/lint-css.sh` | `All CSS rules passed` | |
| 10-4 | GitHub Actions | PRまたはpush後にCI確認 | 全ジョブ緑 | |

---

## 11. アクセシビリティテスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 11-1 | Tab キーでフォーカス移動 | ボタン・フォーム要素に順番にフォーカスが当たる | |
| 11-2 | Enter キーでボタン押下 | ボタンが反応する | |
| 11-3 | Escape キーでモーダルを閉じる | モーダルが閉じる | |
| 11-4 | テーマ切替ボタンの aria-label | "Toggle theme" の aria-label が設定されている | |

---

## 12. パフォーマンステスト

| # | 手順 | 期待結果 | OK/NG |
|---|------|---------|-------|
| 12-1 | Lighthouse（Performance） | スコア 90+ | |
| 12-2 | 初回表示 | 3秒以内にインタラクティブ | |
| 12-3 | プリセット切替 | 即座にコマンドが更新される（体感遅延なし） | |

---

## テスト結果サマリー

| カテゴリ | テスト数 | PASS | FAIL | 備考 |
|---------|---------|------|------|------|
| 基本動作 | 8 | | | |
| テーマ切替 | 9 | | | |
| プリセット選択 | 23 | | | |
| D&D | 6 | | | |
| コマンド出力 | 3 | | | |
| インストールガイド | 11 | | | |
| 実行方法ガイド | 7 | | | |
| 言語切替 | 10 | | | |
| レスポンシブ | 4 | | | |
| CI/CD | 4 | | | |
| アクセシビリティ | 4 | | | |
| パフォーマンス | 3 | | | |
| **合計** | **92** | | | |

---

## テスト実施記録

| 日付 | 実施者 | 環境 | 結果 | 備考 |
|------|--------|------|------|------|
| | | | | |
